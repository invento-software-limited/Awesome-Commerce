{"version":3,"file":"PublishButton.vue_vue_type_script_setup_true_lang-rVUX9hCT.js","sources":["../../../../frontend/src/components/PanelResizer.vue","../../../../frontend/src/components/PublishButton.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"absolute z-20\"\n\t\t:class=\"{\n\t\t\t'top-0 h-full w-1 hover:cursor-ew-resize': side === 'left' || side === 'right',\n\t\t\t'left-0 right-0 h-1 hover:cursor-ns-resize': side === 'top' || side === 'bottom',\n\t\t\t'left-0': side === 'left',\n\t\t\t'right-0': side === 'right',\n\t\t\t'top-0': side === 'top',\n\t\t\t'bottom-0': side === 'bottom',\n\t\t\t'bg-surface-gray-3': dragActive,\n\t\t}\"\n\t\t@mousedown.prevent=\"resize\">\n\t\t<slot />\n\t</div>\n</template>\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nconst props = defineProps({\n\tmaxDimension: {\n\t\ttype: Number,\n\t\tdefault: 350,\n\t},\n\tminDimension: {\n\t\ttype: Number,\n\t\tdefault: 280,\n\t},\n\tdimension: {\n\t\ttype: Number,\n\t\tdefault: 300,\n\t},\n\tside: {\n\t\ttype: String,\n\t\tdefault: \"right\",\n\t\tvalidator: (value: string) => [\"left\", \"right\", \"top\", \"bottom\"].includes(value),\n\t},\n\tresizeSensitivity: {\n\t\ttype: Number,\n\t\tdefault: 1,\n\t},\n});\n\nconst emit = defineEmits({\n\tresize: (width) => width,\n});\n\nconst dragActive = ref(false);\n\ndefineExpose({ dragActive });\n\nfunction resize(ev: MouseEvent) {\n\tconst startX = ev.clientX;\n\tconst startY = ev.clientY;\n\tconst startDimension = props.dimension;\n\tconst target = ev.target as HTMLElement;\n\t// to disable cursor jitter\n\tconst docCursor = document.body.style.cursor;\n\tdocument.body.style.cursor = window.getComputedStyle(target).cursor;\n\n\tconst mousemove = (mouseMoveEvent: MouseEvent) => {\n\t\tlet movement = 0;\n\t\tif ([\"top\", \"bottom\"].includes(props.side)) {\n\t\t\tmovement =\n\t\t\t\t(mouseMoveEvent.clientY - startY) * (props.side === \"top\" ? -1 : 1) * props.resizeSensitivity;\n\t\t} else {\n\t\t\tmovement =\n\t\t\t\t(mouseMoveEvent.clientX - startX) * (props.side === \"left\" ? -1 : 1) * props.resizeSensitivity;\n\t\t}\n\n\t\tlet newDimension = startDimension + movement;\n\t\t// clamp width between min and max\n\t\tnewDimension = Math.min(Math.max(props.minDimension, newDimension), props.maxDimension);\n\t\temit(\"resize\", newDimension);\n\t\tdragActive.value = true;\n\t\tmouseMoveEvent.preventDefault();\n\t};\n\tdocument.addEventListener(\"mousemove\", mousemove);\n\tdocument.addEventListener(\n\t\t\"mouseup\",\n\t\t(mouseUpEvent) => {\n\t\t\tdocument.body.style.cursor = docCursor;\n\t\t\tdocument.removeEventListener(\"mousemove\", mousemove);\n\t\t\tdragActive.value = false;\n\t\t\tmouseUpEvent.preventDefault();\n\t\t},\n\t\t{ once: true },\n\t);\n}\n</script>\n","<template>\n\t<div class=\"flex items-center\">\n\t\t<BuilderButton\n\t\t\tvariant=\"solid\"\n\t\t\t@click=\"\n\t\t\t\t() => {\n\t\t\t\t\tpublishing = true;\n\t\t\t\t\tstore.publishPage().finally(() => (publishing = false));\n\t\t\t\t}\n\t\t\t\"\n\t\t\tclass=\"border-0\"\n\t\t\t:class=\"{\n\t\t\t\t'rounded-br-none rounded-tr-none': store.activePage?.published,\n\t\t\t}\"\n\t\t\t:loading=\"publishing\">\n\t\t\t{{ publishButtonLabel }}\n\t\t</BuilderButton>\n\t\t<Dropdown\n\t\t\tv-if=\"store.activePage?.published\"\n\t\t\t:options=\"[\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Revert Changes',\n\t\t\t\t\tonClick: () => store.revertChanges(),\n\t\t\t\t\tcondition: () => store.activePage?.draft_blocks,\n\t\t\t\t\ticon: 'refresh-cw',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Unpublish',\n\t\t\t\t\tonClick: () => store.unpublishPage(),\n\t\t\t\t\tcondition: () => store.activePage?.published,\n\t\t\t\t\ticon: 'cloud-off',\n\t\t\t\t},\n\t\t\t]\"\n\t\t\tsize=\"sm\"\n\t\t\tclass=\"flex-1 [&>div>div>div]:w-full\"\n\t\t\tplacement=\"right\">\n\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t<BuilderButton\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"open\"\n\t\t\t\t\t:disabled=\"Boolean(store.activePage?.is_template)\"\n\t\t\t\t\ticon=\"chevron-down\"\n\t\t\t\t\tclass=\"!w-6 justify-start rounded-bl-none rounded-tl-none border-0 pr-0 text-xs\"></BuilderButton>\n\t\t\t</template>\n\t\t</Dropdown>\n\t</div>\n</template>\n<script lang=\"ts\" setup>\nimport useStore from \"@/store\";\nimport { Dropdown } from \"frappe-ui\";\nimport { computed, ref } from \"vue\";\n\nconst store = useStore();\nconst publishing = ref(false);\n\nconst publishButtonLabel = computed(() => {\n\tif ((store.activePage?.draft_blocks && !store.activePage?.published) || !store.activePage?.draft_blocks) {\n\t\treturn \"Publish\";\n\t} else {\n\t\treturn \"Publish Changes\";\n\t}\n});\n</script>\n"],"names":["props","__props","emit","__emit","dragActive","ref","__expose","resize","ev","startX","startY","startDimension","target","docCursor","mousemove","mouseMoveEvent","movement","newDimension","mouseUpEvent","_createElementBlock","_renderSlot","_ctx","store","useStore","publishing","publishButtonLabel","computed","_a","_b","_c","_openBlock","_hoisted_1","_createVNode","_component_BuilderButton","_cache","_unref","_createBlock","Dropdown","_withCtx","open"],"mappings":"ujBAkBA,MAAMA,EAAQC,EAwBRC,EAAOC,EAIPC,EAAaC,EAAI,EAAK,EAE5BC,EAAa,CAAE,WAAAF,EAAY,EAE3B,SAASG,EAAOC,EAAgB,CAC/B,MAAMC,EAASD,EAAG,QACZE,EAASF,EAAG,QACZG,EAAiBX,EAAM,UACvBY,EAASJ,EAAG,OAEZK,EAAY,SAAS,KAAK,MAAM,OACtC,SAAS,KAAK,MAAM,OAAS,OAAO,iBAAiBD,CAAM,EAAE,OAE7D,MAAME,EAAaC,GAA+B,CACjD,IAAIC,EAAW,EACX,CAAC,MAAO,QAAQ,EAAE,SAAShB,EAAM,IAAI,EACxCgB,GACED,EAAe,QAAUL,IAAWV,EAAM,OAAS,MAAQ,GAAK,GAAKA,EAAM,kBAE7EgB,GACED,EAAe,QAAUN,IAAWT,EAAM,OAAS,OAAS,GAAK,GAAKA,EAAM,kBAG/E,IAAIiB,EAAeN,EAAiBK,EAEpCC,EAAe,KAAK,IAAI,KAAK,IAAIjB,EAAM,aAAciB,CAAY,EAAGjB,EAAM,YAAY,EACtFE,EAAK,SAAUe,CAAY,EAC3Bb,EAAW,MAAQ,GACnBW,EAAe,eAAA,CAAe,EAE/B,SAAS,iBAAiB,YAAaD,CAAS,EAChD,SAAS,iBACR,UACCI,GAAiB,CACjB,SAAS,KAAK,MAAM,OAASL,EAC7B,SAAS,oBAAoB,YAAaC,CAAS,EACnDV,EAAW,MAAQ,GACnBc,EAAa,eAAA,CAAe,EAE7B,CAAE,KAAM,EAAA,CAAK,CACd,mBArFAC,EAaM,MAAA,CAZL,SAAM,gBAAe,CACmC,0CAAAlB,EAAA,eAAmBA,EAAA,OAAI,QAA8D,4CAAAA,EAAA,cAAkBA,EAAA,OAAI,kBAA4BA,EAAA,OAAI,iBAA2BA,EAAA,OAAI,gBAA0BA,EAAA,OAAI,iBAA2BA,EAAA,OAAI,6BAAuCG,EAAA,KAAA,IASrU,cAAmBG,EAAM,CAAA,SAAA,CAAA,CAAA,GAC1Ba,EAAQC,EAAA,OAAA,SAAA,CAAA,6ECuCV,MAAMC,EAAQC,EAAA,EACRC,EAAanB,EAAI,EAAK,EAEtBoB,EAAqBC,EAAS,IAAM,WACzC,OAAKC,EAAAL,EAAM,aAAN,MAAAK,EAAkB,cAAgB,GAACC,EAAAN,EAAM,aAAN,MAAAM,EAAkB,YAAc,GAACC,EAAAP,EAAM,aAAN,MAAAO,EAAkB,cACnF,UAEA,iBACR,CACA,mDA5DA,OAAAC,EAAA,EAAAX,EA4CM,MA5CNY,EA4CM,CA3CLC,EAcgBC,EAAA,CAbf,QAAQ,QACP,QAAKC,EAAA,CAAA,IAAAA,EAAA,CAAA,OAAoBV,EAAA,MAAU,GAAcW,EAAAb,CAAA,EAAM,YAAA,EAAc,YAAeE,EAAA,MAAU,EAAA,CAAA,GAM/F,SAAM,WAAU,oCACiCW,EAAAA,EAAAb,CAAA,EAAM,aAANa,YAAAA,EAAkB,SAAA,IAGlE,QAASX,EAAA,KAAA,aACV,IAAwB,KAArBC,EAAA,KAAkB,EAAA,CAAA,CAAA,gCAGfU,EAAAA,EAAAb,CAAA,EAAM,aAANa,MAAAA,EAAkB,eADzBC,EA2BWD,EAAAE,CAAA,EAAA,OAzBT,QAAO,yBAA4D,QAAA,IAAAF,EAAAb,CAAA,EAAM,cAAA,uBAAuCa,OAAAA,EAAAA,EAAAb,CAAA,EAAM,aAANa,YAAAA,EAAkB,oDAAiG,QAAA,IAAAA,EAAAb,CAAA,EAAM,cAAA,uBAAuCa,OAAAA,EAAAA,EAAAb,CAAA,EAAM,aAANa,YAAAA,EAAkB,8BAcnS,KAAK,KACL,MAAM,gCACN,UAAU,OAAA,GAET,QAAAG,EAAA,CAKkG,CAN/E,KAAAC,KAAI,OAAA,OACvBP,EAKkGC,EAAA,CAJjG,QAAQ,QACP,QAAOM,EACP,SAAU,IAAQJ,EAAAA,KAAM,aAANA,MAAAA,EAAkB,aACrC,KAAK,eACL,MAAM,0EAAA"}