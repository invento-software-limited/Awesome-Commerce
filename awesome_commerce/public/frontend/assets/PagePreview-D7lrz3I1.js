var F=Object.defineProperty;var R=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var z=(r,n,t)=>n in r?F(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t,W=(r,n)=>{for(var t in n||(n={}))M.call(n,t)&&z(r,t,n[t]);if(R)for(var t of R(n))N.call(n,t)&&z(r,t,n[t]);return r};import{d as S,r as l,v as A,c as C,E as H,bU as T,D as U,C as q,a as p,g as u,l as c,w as g,f as O,m as P,u as x,d6 as G,F as J,j as K,k as Q,n as L,b as I,aW as X,dH as Y,o as w,H as Z}from"./index-CjINglDs.js";import{a as ee,_ as j}from"./PublishButton.vue_vue_type_script_setup_true_lang-rVUX9hCT.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-GiONCyNQ.js";const te={class:"flex h-screen flex-col items-center bg-surface-white py-2"},se={class:"relative flex w-full items-center justify-center"},ne={class:"flex gap-1"},ie=["onClick"],ae=["src"],oe={key:1,class:"absolute flex h-full w-full items-center justify-center"},y=400,ce=S({__name:"PagePreview",setup(r){const n=G(),t=window.innerWidth*.92;let h=l("");const o=l(t),_=l(!1),D=A();l(!1);const v=[{icon:"monitor",device:"desktop",width:1400},{icon:"tablet",device:"tablet",width:800},{icon:"smartphone",device:"mobile",width:420}],b=l(null),k=l(null),V=C(()=>{var s,e;return((s=b.value)==null?void 0:s.dragActive)||((e=k.value)==null?void 0:e.dragActive)}),E=C(()=>{const s=v.find(i=>i.device==="tablet"),e=v.find(i=>i.device==="mobile");return o.value<=((e==null?void 0:e.width)||y)?"mobile":o.value<=((s==null?void 0:s.width)||t)?"tablet":"desktop"}),d=l(null);H(document,"keydown",s=>{s.key==="Escape"&&Y.currentRoute.value.name==="preview"&&history.back()}),T(()=>{d.value&&(_.value=!0,d.value.addEventListener("load",()=>{var s,e,i,f,a;setTimeout(()=>{_.value=!1},100),(s=d.value)==null||s.addEventListener("mousedown",m=>{document.dispatchEvent(new MouseEvent("mousedown",m))}),(i=(e=d.value)==null?void 0:e.contentWindow)==null||i.document.addEventListener("mouseup",m=>{document.dispatchEvent(new MouseEvent("mouseup",m))}),(a=(f=d.value)==null?void 0:f.contentWindow)==null||a.document.addEventListener("mousemove",m=>{document.dispatchEvent(new MouseEvent("mousemove",m))})},{once:!0}))});const $=s=>{const e=v.find(i=>i.device===s);e&&(e.device==="desktop"?o.value=t:o.value=e.width)},B=()=>{let s=W({page:n.params.pageId},D.routeVariables);h.value=`/api/method/builder.api.get_page_preview_html?${Object.entries(s).map(([e,i])=>`${e}=${i}`).join("&")}`};return U(()=>n.params.pageId,()=>{B()},{immediate:!0}),q(()=>{Z.capture("builder_page_preview_viewed")}),(s,e)=>{const i=P("FeatherIcon"),f=P("router-link");return w(),p("div",te,[u("div",se,[c(f,{to:{name:"builder",params:{pageId:x(n).params.pageId||"new"}},class:"absolute left-3 flex w-fit text-sm text-ink-gray-7 hover:text-ink-gray-9"},{default:g(()=>[c(i,{name:"arrow-left",class:"mr-4 h-4 w-4 cursor-pointer"}),e[2]||(e[2]=O(" Back to builder "))]),_:1,__:[2]},8,["to"]),u("div",ne,[(w(),p(J,null,K(v,a=>u("div",{class:L(["w-auto cursor-pointer rounded-md p-1 px-[8px]",{"bg-surface-white":E.value===a.device}]),key:a.device,onClick:Q(()=>$(a.device),["stop"])},[c(i,{name:a.icon,class:L(["h-6 w-5 text-ink-gray-4",{"text-ink-gray-9":E.value===a.device}])},null,8,["name","class"])],10,ie)),64))]),c(ee,{class:"absolute right-3 border-0"})]),u("div",{class:"relative mt-5 flex h-[85vh] bg-white",style:X({width:o.value+"px"})},[c(j,{class:"ml-[-12px]",side:"left",dimension:o.value,minDimension:y,maxDimension:t,resizeSensitivity:2,ref_key:"leftPanelRef",ref:b,onResize:e[0]||(e[0]=a=>o.value=a)},{default:g(()=>e[3]||(e[3]=[u("div",{class:"resize-handler-left h-full w-2 rounded-sm bg-surface-gray-2"},null,-1)])),_:1,__:[3]},8,["dimension"]),x(h)?(w(),p("iframe",{key:0,src:x(h),frameborder:"0",class:"flex-1 rounded-sm",ref_key:"previewWindow",ref:d},null,8,ae)):I("",!0),_.value||V.value?(w(),p("div",oe)):I("",!0),c(j,{class:"mr-[-8px]",side:"right",dimension:o.value,minDimension:y,maxDimension:t,resizeSensitivity:2,ref_key:"rightPanelRef",ref:k,onResize:e[1]||(e[1]=a=>o.value=a)},{default:g(()=>e[4]||(e[4]=[u("div",{class:"resize-handler-left h-full w-2 rounded-sm bg-surface-gray-2"},null,-1)])),_:1,__:[4]},8,["dimension"])],4)])}}});export{ce as default};
//# sourceMappingURL=PagePreview-D7lrz3I1.js.map
