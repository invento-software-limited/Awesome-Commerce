{"version":3,"file":"PublishButton.vue_vue_type_script_setup_true_lang-Cd-lMxYd.js","sources":["../../../../frontend/src/components/PanelResizer.vue","../../../../frontend/src/components/PublishButton.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"absolute z-20\"\n\t\t:class=\"{\n\t\t\t'top-0 h-full w-1 hover:cursor-ew-resize': side === 'left' || side === 'right',\n\t\t\t'left-0 right-0 h-1 hover:cursor-ns-resize': side === 'top' || side === 'bottom',\n\t\t\t'left-0': side === 'left',\n\t\t\t'right-0': side === 'right',\n\t\t\t'top-0': side === 'top',\n\t\t\t'bottom-0': side === 'bottom',\n\t\t\t'bg-surface-gray-3': dragActive,\n\t\t}\"\n\t\t@mousedown.prevent=\"resize\">\n\t\t<slot />\n\t</div>\n</template>\n<script setup lang=\"ts\">\nimport { ref } from \"vue\";\nconst props = withDefaults(\n\tdefineProps<{\n\t\tmaxDimension?: number;\n\t\tminDimension?: number;\n\t\tdimension?: number;\n\t\tside?: \"left\" | \"right\" | \"top\" | \"bottom\";\n\t\tresizeSensitivity?: number;\n\t}>(),\n\t{\n\t\tmaxDimension: 350,\n\t\tminDimension: 280,\n\t\tdimension: 300,\n\t\tside: \"right\",\n\t\tresizeSensitivity: 1,\n\t},\n);\n\nconst emit = defineEmits({\n\tresize: (width) => width,\n});\n\nconst dragActive = ref(false);\n\ndefineExpose({ dragActive });\n\nfunction resize(ev: MouseEvent) {\n\tconst startX = ev.clientX;\n\tconst startY = ev.clientY;\n\tconst startDimension = props.dimension;\n\tconst target = ev.target as HTMLElement;\n\t// to disable cursor jitter\n\tconst docCursor = document.body.style.cursor;\n\tdocument.body.style.cursor = window.getComputedStyle(target).cursor;\n\n\tconst mousemove = (mouseMoveEvent: MouseEvent) => {\n\t\tlet movement = 0;\n\t\tif ([\"top\", \"bottom\"].includes(props.side)) {\n\t\t\tmovement =\n\t\t\t\t(mouseMoveEvent.clientY - startY) * (props.side === \"top\" ? -1 : 1) * props.resizeSensitivity;\n\t\t} else {\n\t\t\tmovement =\n\t\t\t\t(mouseMoveEvent.clientX - startX) * (props.side === \"left\" ? -1 : 1) * props.resizeSensitivity;\n\t\t}\n\n\t\tlet newDimension = startDimension + movement;\n\t\t// clamp width between min and max\n\t\tnewDimension = Math.min(Math.max(props.minDimension, newDimension), props.maxDimension);\n\t\temit(\"resize\", newDimension);\n\t\tdragActive.value = true;\n\t\tmouseMoveEvent.preventDefault();\n\t};\n\tdocument.addEventListener(\"mousemove\", mousemove);\n\tdocument.addEventListener(\n\t\t\"mouseup\",\n\t\t(mouseUpEvent) => {\n\t\t\tdocument.body.style.cursor = docCursor;\n\t\t\tdocument.removeEventListener(\"mousemove\", mousemove);\n\t\t\tdragActive.value = false;\n\t\t\tmouseUpEvent.preventDefault();\n\t\t},\n\t\t{ once: true },\n\t);\n}\n</script>\n","<template>\n\t<div class=\"flex items-center\">\n\t\t<BuilderButton\n\t\t\tvariant=\"solid\"\n\t\t\t:disabled=\"canvasStore.editingMode === 'fragment'\"\n\t\t\t@click=\"\n\t\t\t\t() => {\n\t\t\t\t\tpublishing = true;\n\t\t\t\t\tpageStore.publishPage().finally(() => (publishing = false));\n\t\t\t\t}\n\t\t\t\"\n\t\t\tclass=\"border-0\"\n\t\t\t:class=\"{\n\t\t\t\t'rounded-br-none rounded-tr-none': showDropdown,\n\t\t\t}\"\n\t\t\t:loading=\"publishing\">\n\t\t\t{{ publishButtonLabel }}\n\t\t</BuilderButton>\n\t\t<Dropdown\n\t\t\tv-show=\"showDropdown\"\n\t\t\t:options=\"[\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Revert Changes',\n\t\t\t\t\tonClick: () => pageStore.revertChanges(),\n\t\t\t\t\tcondition: () => pageStore.activePage?.draft_blocks,\n\t\t\t\t\ticon: 'refresh-cw',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Unpublish',\n\t\t\t\t\tonClick: () => pageStore.unpublishPage(),\n\t\t\t\t\tcondition: () => Boolean(pageStore.activePage?.published),\n\t\t\t\t\ticon: 'cloud-off',\n\t\t\t\t},\n\t\t\t]\"\n\t\t\tsize=\"sm\"\n\t\t\tclass=\"flex-1 [&>div>div>div]:w-full\"\n\t\t\tplacement=\"right\">\n\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t<BuilderButton\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"open\"\n\t\t\t\t\t:disabled=\"Boolean(pageStore.activePage?.is_template)\"\n\t\t\t\t\ticon=\"chevron-down\"\n\t\t\t\t\tclass=\"!w-6 justify-start rounded-bl-none rounded-tl-none border-0 pr-0 text-xs\"></BuilderButton>\n\t\t\t</template>\n\t\t</Dropdown>\n\t</div>\n</template>\n<script lang=\"ts\" setup>\nimport useCanvasStore from \"@/stores/canvasStore\";\nimport usePageStore from \"@/stores/pageStore\";\nimport { Dropdown } from \"frappe-ui\";\nimport { computed, ref } from \"vue\";\n\nconst pageStore = usePageStore();\nconst canvasStore = useCanvasStore();\n\nconst publishing = ref(false);\nconst showDropdown = computed(() => {\n\treturn Boolean(pageStore.activePage?.published) && canvasStore.editingMode !== \"fragment\";\n});\n\nconst publishButtonLabel = computed(() => {\n\tif (\n\t\t(pageStore.activePage?.draft_blocks && !pageStore.activePage?.published) ||\n\t\t!pageStore.activePage?.draft_blocks\n\t) {\n\t\treturn \"Publish\";\n\t} else {\n\t\treturn \"Publish Changes\";\n\t}\n});\n</script>\n"],"names":["props","__props","emit","__emit","dragActive","ref","__expose","resize","ev","startX","startY","startDimension","target","docCursor","mousemove","mouseMoveEvent","movement","newDimension","mouseUpEvent","_createElementBlock","side","_renderSlot","_ctx","pageStore","usePageStore","canvasStore","useCanvasStore","publishing","showDropdown","computed","_a","publishButtonLabel","_b","_c","_openBlock","_hoisted_1","_createVNode","_component_BuilderButton","_unref","_cache","Dropdown","_withCtx","open"],"mappings":"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"}