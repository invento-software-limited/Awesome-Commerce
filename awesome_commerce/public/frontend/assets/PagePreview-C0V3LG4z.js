var j=Object.defineProperty;var R=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var z=(r,n,t)=>n in r?j(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t,P=(r,n)=>{for(var t in n||(n={}))B.call(n,t)&&z(r,t,n[t]);if(R)for(var t of R(n))F.call(n,t)&&z(r,t,n[t]);return r};import{d as N,d8 as A,r as d,D as T,c as W,M as q,b_ as J,K,i as C,a as p,o as w,g as u,m as c,w as g,f as O,u as x,F as Q,k as U,l as G,n as L,b as D,b1 as H,dJ as X,Q as Y}from"./index-HlVA34VQ.js";import{a as Z,_ as I}from"./PublishButton.vue_vue_type_script_setup_true_lang-Cd-lMxYd.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-B0tMPLRs.js";const ee={class:"flex h-screen flex-col items-center bg-surface-white py-2"},te={class:"relative flex w-full items-center justify-center"},se={class:"flex gap-1"},ne=["onClick"],ie=["src"],ae={key:1,class:"absolute flex h-full w-full items-center justify-center"},y=400,ue=N({__name:"PagePreview",setup(r){const n=A(),t=window.innerWidth*.92;let h=d("");const o=d(t),_=d(!1),M=T(),v=[{icon:"monitor",device:"desktop",width:1400},{icon:"tablet",device:"tablet",width:800},{icon:"smartphone",device:"mobile",width:420}],b=d(null),k=d(null),S=W(()=>{var s,e;return((s=b.value)==null?void 0:s.dragActive)||((e=k.value)==null?void 0:e.dragActive)}),E=W(()=>{const s=v.find(i=>i.device==="tablet"),e=v.find(i=>i.device==="mobile");return o.value<=((e==null?void 0:e.width)||y)?"mobile":o.value<=((s==null?void 0:s.width)||t)?"tablet":"desktop"}),l=d(null);q(document,"keydown",s=>{s.key==="Escape"&&X.currentRoute.value.name==="preview"&&history.back()}),J(()=>{l.value&&(_.value=!0,l.value.addEventListener("load",()=>{var s,e,i,f,a;setTimeout(()=>{_.value=!1},100),(s=l.value)==null||s.addEventListener("mousedown",m=>{document.dispatchEvent(new MouseEvent("mousedown",m))}),(i=(e=l.value)==null?void 0:e.contentWindow)==null||i.document.addEventListener("mouseup",m=>{document.dispatchEvent(new MouseEvent("mouseup",m))}),(a=(f=l.value)==null?void 0:f.contentWindow)==null||a.document.addEventListener("mousemove",m=>{document.dispatchEvent(new MouseEvent("mousemove",m))})},{once:!0}))});const V=s=>{const e=v.find(i=>i.device===s);e&&(e.device==="desktop"?o.value=t:o.value=e.width)},$=()=>{let s=P({page:n.params.pageId},M.routeVariables);h.value=`/api/method/builder.api.get_page_preview_html?${Object.entries(s).map(([e,i])=>`${e}=${i}`).join("&")}`};return K(()=>{$(),Y.capture("builder_page_preview_viewed")}),(s,e)=>{const i=C("FeatherIcon"),f=C("router-link");return w(),p("div",ee,[u("div",te,[c(f,{to:{name:"builder",params:{pageId:x(n).params.pageId||"new"}},class:"absolute left-3 flex w-fit text-sm text-ink-gray-7 hover:text-ink-gray-9"},{default:g(()=>[c(i,{name:"arrow-left",class:"mr-4 h-4 w-4 cursor-pointer"}),e[2]||(e[2]=O(" Back to builder "))]),_:1,__:[2]},8,["to"]),u("div",se,[(w(),p(Q,null,U(v,a=>u("div",{class:L(["w-auto cursor-pointer rounded-md p-1 px-[8px]",{"bg-surface-white":E.value===a.device}]),key:a.device,onClick:G(()=>V(a.device),["stop"])},[c(i,{name:a.icon,class:L(["h-6 w-5 text-ink-gray-4",{"text-ink-gray-9":E.value===a.device}])},null,8,["name","class"])],10,ne)),64))]),c(Z,{class:"absolute right-3 border-0"})]),u("div",{class:"relative mt-5 flex h-[85vh] bg-white",style:H({width:o.value+"px"})},[c(I,{class:"ml-[-12px]",side:"left",dimension:o.value,minDimension:y,maxDimension:t,resizeSensitivity:2,ref_key:"leftPanelRef",ref:b,onResize:e[0]||(e[0]=a=>o.value=a)},{default:g(()=>e[3]||(e[3]=[u("div",{class:"resize-handler-left h-full w-2 rounded-sm bg-surface-gray-2"},null,-1)])),_:1,__:[3]},8,["dimension"]),x(h)?(w(),p("iframe",{key:0,src:x(h),frameborder:"0",class:"flex-1 rounded-sm",ref_key:"previewWindow",ref:l},null,8,ie)):D("",!0),_.value||S.value?(w(),p("div",ae)):D("",!0),c(I,{class:"mr-[-8px]",side:"right",dimension:o.value,minDimension:y,maxDimension:t,resizeSensitivity:2,ref_key:"rightPanelRef",ref:k,onResize:e[1]||(e[1]=a=>o.value=a)},{default:g(()=>e[4]||(e[4]=[u("div",{class:"resize-handler-left h-full w-2 rounded-sm bg-surface-gray-2"},null,-1)])),_:1,__:[4]},8,["dimension"])],4)])}}});export{ue as default};
//# sourceMappingURL=PagePreview-C0V3LG4z.js.map
